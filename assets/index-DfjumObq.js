import{aX as R}from"./index-B8EwGL3f.js";const Jt=()=>"9.1.0",Zt=e=>e.toString(16).padStart(2,"0"),xt=e=>{const t=new Uint8Array(e/2);return window.crypto.getRandomValues(t),Array.from(t,Zt).join("")},en=()=>typeof window<"u"?xt(10):new Date().getTime().toString(36);class W{}W.makeRequest=(e,t)=>({id:en(),method:e,params:t,env:{sdkVersion:Jt()}});W.makeResponse=(e,t,n)=>({id:e,success:!0,version:n,data:t});W.makeErrorResponse=(e,t,n)=>({id:e,success:!1,error:t,version:n});var m;(function(e){e.sendTransactions="sendTransactions",e.rpcCall="rpcCall",e.getChainInfo="getChainInfo",e.getSafeInfo="getSafeInfo",e.getTxBySafeTxHash="getTxBySafeTxHash",e.getSafeBalances="getSafeBalances",e.signMessage="signMessage",e.signTypedMessage="signTypedMessage",e.getEnvironmentInfo="getEnvironmentInfo",e.getOffChainSignature="getOffChainSignature",e.requestAddressBook="requestAddressBook",e.wallet_getPermissions="wallet_getPermissions",e.wallet_requestPermissions="wallet_requestPermissions"})(m||(m={}));var J;(function(e){e.requestAddressBook="requestAddressBook"})(J||(J={}));class tn{constructor(t=null,n=!1){this.allowedOrigins=null,this.callbacks=new Map,this.debugMode=!1,this.isServer=typeof window>"u",this.isValidMessage=({origin:i,data:s,source:r})=>{const o=!s,c=!this.isServer&&r===window.parent,l=typeof s.version<"u"&&parseInt(s.version.split(".")[0]),g=typeof l=="number"&&l>=1;let h=!0;return Array.isArray(this.allowedOrigins)&&(h=this.allowedOrigins.find(y=>y.test(i))!==void 0),!o&&c&&g&&h},this.logIncomingMessage=i=>{console.info(`Safe Apps SDK v1: A message was received from origin ${i.origin}. `,i.data)},this.onParentMessage=i=>{this.isValidMessage(i)&&(this.debugMode&&this.logIncomingMessage(i),this.handleIncomingMessage(i.data))},this.handleIncomingMessage=i=>{const{id:s}=i,r=this.callbacks.get(s);r&&(r(i),this.callbacks.delete(s))},this.send=(i,s)=>{const r=W.makeRequest(i,s);if(this.isServer)throw new Error("Window doesn't exist");return window.parent.postMessage(r,"*"),new Promise((o,c)=>{this.callbacks.set(r.id,l=>{if(!l.success){c(new Error(l.error));return}o(l)})})},this.allowedOrigins=t,this.debugMode=n,this.isServer||window.addEventListener("message",this.onParentMessage)}}const Se=e=>typeof e=="object"&&e!=null&&"domain"in e&&"types"in e&&"message"in e;var nn={},b={},T={},ne=R&&R.__awaiter||function(e,t,n,i){function s(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function c(h){try{g(i.next(h))}catch(y){o(y)}}function l(h){try{g(i.throw(h))}catch(y){o(y)}}function g(h){h.done?r(h.value):s(h.value).then(c,l)}g((i=i.apply(e,t||[])).next())})};Object.defineProperty(T,"__esModule",{value:!0});T.getData=T.fetchData=T.stringifyQuery=T.insertParams=void 0;const sn=e=>typeof e=="object"&&e!==null&&"code"in e&&"message"in e;function rn(e,t,n){return e.replace(new RegExp(`\\{${t}\\}`,"g"),n)}function on(e,t){return t?Object.keys(t).reduce((n,i)=>rn(n,i,String(t[i])),e):e}T.insertParams=on;function an(e){if(!e)return"";const t=new URLSearchParams;Object.keys(e).forEach(i=>{e[i]!=null&&t.append(i,String(e[i]))});const n=t.toString();return n?`?${n}`:""}T.stringifyQuery=an;function ve(e){return ne(this,void 0,void 0,function*(){let t;try{t=yield e.json()}catch{t={}}if(!e.ok){const n=sn(t)?`CGW error - ${t.code}: ${t.message}`:`CGW error - status ${e.statusText}`;throw new Error(n)}return t})}function cn(e,t,n,i,s){return ne(this,void 0,void 0,function*(){const r=Object.assign({"Content-Type":"application/json"},i),o={method:t??"POST",headers:r};s&&(o.credentials=s),n!=null&&(o.body=typeof n=="string"?n:JSON.stringify(n));const c=yield fetch(e,o);return ve(c)})}T.fetchData=cn;function un(e,t,n){return ne(this,void 0,void 0,function*(){const i={method:"GET"};t&&(i.headers=Object.assign(Object.assign({},t),{"Content-Type":"application/json"})),n&&(i.credentials=n);const s=yield fetch(e,i);return ve(s)})}T.getData=un;Object.defineProperty(b,"__esModule",{value:!0});b.getEndpoint=b.deleteEndpoint=b.putEndpoint=b.postEndpoint=void 0;const P=T;function V(e,t,n,i){const s=(0,P.insertParams)(t,n),r=(0,P.stringifyQuery)(i);return`${e}${s}${r}`}function fn(e,t,n){const i=V(e,t,n?.path,n?.query);return(0,P.fetchData)(i,"POST",n?.body,n?.headers,n?.credentials)}b.postEndpoint=fn;function dn(e,t,n){const i=V(e,t,n?.path,n?.query);return(0,P.fetchData)(i,"PUT",n?.body,n?.headers,n?.credentials)}b.putEndpoint=dn;function ln(e,t,n){const i=V(e,t,n?.path,n?.query);return(0,P.fetchData)(i,"DELETE",n?.body,n?.headers,n?.credentials)}b.deleteEndpoint=ln;function hn(e,t,n,i){if(i)return(0,P.getData)(i,void 0,n?.credentials);const s=V(e,t,n?.path,n?.query);return(0,P.getData)(s,n?.headers,n?.credentials)}b.getEndpoint=hn;var q={};Object.defineProperty(q,"__esModule",{value:!0});q.DEFAULT_BASE_URL=void 0;q.DEFAULT_BASE_URL="https://safe-client.safe.global";var we={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ImplementationVersionState=void 0,function(t){t.UP_TO_DATE="UP_TO_DATE",t.OUTDATED="OUTDATED",t.UNKNOWN="UNKNOWN"}(e.ImplementationVersionState||(e.ImplementationVersionState={}))})(we);var Oe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SafeAppSocialPlatforms=e.SafeAppFeatures=e.SafeAppAccessPolicyTypes=void 0,function(t){t.NoRestrictions="NO_RESTRICTIONS",t.DomainAllowlist="DOMAIN_ALLOWLIST"}(e.SafeAppAccessPolicyTypes||(e.SafeAppAccessPolicyTypes={})),function(t){t.BATCHED_TRANSACTIONS="BATCHED_TRANSACTIONS"}(e.SafeAppFeatures||(e.SafeAppFeatures={})),function(t){t.TWITTER="TWITTER",t.GITHUB="GITHUB",t.DISCORD="DISCORD"}(e.SafeAppSocialPlatforms||(e.SafeAppSocialPlatforms={}))})(Oe);var Ne={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LabelValue=e.StartTimeValue=e.DurationType=e.DetailedExecutionInfoType=e.TransactionListItemType=e.ConflictType=e.TransactionInfoType=e.SettingsInfoType=e.TransactionTokenType=e.TransferDirection=e.TransactionStatus=e.Operation=void 0,function(t){t[t.CALL=0]="CALL",t[t.DELEGATE=1]="DELEGATE"}(e.Operation||(e.Operation={})),function(t){t.AWAITING_CONFIRMATIONS="AWAITING_CONFIRMATIONS",t.AWAITING_EXECUTION="AWAITING_EXECUTION",t.CANCELLED="CANCELLED",t.FAILED="FAILED",t.SUCCESS="SUCCESS"}(e.TransactionStatus||(e.TransactionStatus={})),function(t){t.INCOMING="INCOMING",t.OUTGOING="OUTGOING",t.UNKNOWN="UNKNOWN"}(e.TransferDirection||(e.TransferDirection={})),function(t){t.ERC20="ERC20",t.ERC721="ERC721",t.NATIVE_COIN="NATIVE_COIN"}(e.TransactionTokenType||(e.TransactionTokenType={})),function(t){t.SET_FALLBACK_HANDLER="SET_FALLBACK_HANDLER",t.ADD_OWNER="ADD_OWNER",t.REMOVE_OWNER="REMOVE_OWNER",t.SWAP_OWNER="SWAP_OWNER",t.CHANGE_THRESHOLD="CHANGE_THRESHOLD",t.CHANGE_IMPLEMENTATION="CHANGE_IMPLEMENTATION",t.ENABLE_MODULE="ENABLE_MODULE",t.DISABLE_MODULE="DISABLE_MODULE",t.SET_GUARD="SET_GUARD",t.DELETE_GUARD="DELETE_GUARD"}(e.SettingsInfoType||(e.SettingsInfoType={})),function(t){t.TRANSFER="Transfer",t.SETTINGS_CHANGE="SettingsChange",t.CUSTOM="Custom",t.CREATION="Creation",t.SWAP_ORDER="SwapOrder",t.TWAP_ORDER="TwapOrder",t.SWAP_TRANSFER="SwapTransfer"}(e.TransactionInfoType||(e.TransactionInfoType={})),function(t){t.NONE="None",t.HAS_NEXT="HasNext",t.END="End"}(e.ConflictType||(e.ConflictType={})),function(t){t.TRANSACTION="TRANSACTION",t.LABEL="LABEL",t.CONFLICT_HEADER="CONFLICT_HEADER",t.DATE_LABEL="DATE_LABEL"}(e.TransactionListItemType||(e.TransactionListItemType={})),function(t){t.MULTISIG="MULTISIG",t.MODULE="MODULE"}(e.DetailedExecutionInfoType||(e.DetailedExecutionInfoType={})),function(t){t.AUTO="AUTO",t.LIMIT_DURATION="LIMIT_DURATION"}(e.DurationType||(e.DurationType={})),function(t){t.AT_MINING_TIME="AT_MINING_TIME",t.AT_EPOCH="AT_EPOCH"}(e.StartTimeValue||(e.StartTimeValue={})),function(t){t.Queued="Queued",t.Next="Next"}(e.LabelValue||(e.LabelValue={}))})(Ne);var Ce={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.FEATURES=e.GAS_PRICE_TYPE=e.RPC_AUTHENTICATION=void 0,function(t){t.API_KEY_PATH="API_KEY_PATH",t.NO_AUTHENTICATION="NO_AUTHENTICATION",t.UNKNOWN="UNKNOWN"}(e.RPC_AUTHENTICATION||(e.RPC_AUTHENTICATION={})),function(t){t.ORACLE="ORACLE",t.FIXED="FIXED",t.FIXED_1559="FIXED1559",t.UNKNOWN="UNKNOWN"}(e.GAS_PRICE_TYPE||(e.GAS_PRICE_TYPE={})),function(t){t.ERC721="ERC721",t.SAFE_APPS="SAFE_APPS",t.CONTRACT_INTERACTION="CONTRACT_INTERACTION",t.DOMAIN_LOOKUP="DOMAIN_LOOKUP",t.SPENDING_LIMIT="SPENDING_LIMIT",t.EIP1559="EIP1559",t.SAFE_TX_GAS_OPTIONAL="SAFE_TX_GAS_OPTIONAL",t.TX_SIMULATION="TX_SIMULATION",t.EIP1271="EIP1271"}(e.FEATURES||(e.FEATURES={}))})(Ce);var De={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TokenType=void 0,function(t){t.ERC20="ERC20",t.ERC721="ERC721",t.NATIVE_TOKEN="NATIVE_TOKEN"}(e.TokenType||(e.TokenType={}))})(De);var Pe={};Object.defineProperty(Pe,"__esModule",{value:!0});var Me={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConfirmationViewTypes=void 0,function(t){t.COW_SWAP_ORDER="COW_SWAP_ORDER",t.COW_SWAP_TWAP_ORDER="COW_SWAP_TWAP_ORDER"}(e.ConfirmationViewTypes||(e.ConfirmationViewTypes={}))})(Me);var Re={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SafeMessageStatus=e.SafeMessageListItemType=void 0,function(t){t.DATE_LABEL="DATE_LABEL",t.MESSAGE="MESSAGE"}(e.SafeMessageListItemType||(e.SafeMessageListItemType={})),function(t){t.NEEDS_CONFIRMATION="NEEDS_CONFIRMATION",t.CONFIRMED="CONFIRMED"}(e.SafeMessageStatus||(e.SafeMessageStatus={}))})(Re);var $e={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DeviceType=void 0,function(t){t.ANDROID="ANDROID",t.IOS="IOS",t.WEB="WEB"}(e.DeviceType||(e.DeviceType={}))})($e);var Le={};Object.defineProperty(Le,"__esModule",{value:!0});(function(e){var t=R&&R.__createBinding||(Object.create?function(a,u,f,d){d===void 0&&(d=f);var w=Object.getOwnPropertyDescriptor(u,f);(!w||("get"in w?!u.__esModule:w.writable||w.configurable))&&(w={enumerable:!0,get:function(){return u[f]}}),Object.defineProperty(a,d,w)}:function(a,u,f,d){d===void 0&&(d=f),a[d]=u[f]}),n=R&&R.__exportStar||function(a,u){for(var f in a)f!=="default"&&!Object.prototype.hasOwnProperty.call(u,f)&&t(u,a,f)};Object.defineProperty(e,"__esModule",{value:!0}),e.deleteAccount=e.getAccount=e.createAccount=e.verifyAuth=e.getAuthNonce=e.getContract=e.getSafeOverviews=e.unsubscribeAll=e.unsubscribeSingle=e.registerRecoveryModule=e.deleteRegisteredEmail=e.getRegisteredEmail=e.verifyEmail=e.resendEmailVerificationCode=e.changeEmail=e.registerEmail=e.unregisterDevice=e.unregisterSafe=e.registerDevice=e.getDelegates=e.confirmSafeMessage=e.proposeSafeMessage=e.getSafeMessage=e.getSafeMessages=e.getDecodedData=e.getMasterCopies=e.getSafeApps=e.getChainConfig=e.getChainsConfig=e.getConfirmationView=e.proposeTransaction=e.getNonces=e.postSafeGasEstimation=e.deleteTransaction=e.getTransactionDetails=e.getTransactionQueue=e.getTransactionHistory=e.getCollectiblesPage=e.getCollectibles=e.getAllOwnedSafes=e.getOwnedSafes=e.getFiatCurrencies=e.getBalances=e.getMultisigTransactions=e.getModuleTransactions=e.getIncomingTransfers=e.getSafeInfo=e.getRelayCount=e.relayTransaction=e.setBaseUrl=void 0,e.putAccountDataSettings=e.getAccountDataSettings=e.getAccountDataTypes=void 0;const i=b,s=q;n(we,e),n(Oe,e),n(Ne,e),n(Ce,e),n(De,e),n(Pe,e),n(Me,e),n(Re,e),n($e,e),n(Le,e);let r=s.DEFAULT_BASE_URL;const o=a=>{r=a};e.setBaseUrl=o;function c(a,u){return(0,i.postEndpoint)(r,"/v1/chains/{chainId}/relay",{path:{chainId:a},body:u})}e.relayTransaction=c;function l(a,u){return(0,i.getEndpoint)(r,"/v1/chains/{chainId}/relay/{address}",{path:{chainId:a,address:u}})}e.getRelayCount=l;function g(a,u){return(0,i.getEndpoint)(r,"/v1/chains/{chainId}/safes/{address}",{path:{chainId:a,address:u}})}e.getSafeInfo=g;function h(a,u,f,d){return(0,i.getEndpoint)(r,"/v1/chains/{chainId}/safes/{address}/incoming-transfers/",{path:{chainId:a,address:u},query:f},d)}e.getIncomingTransfers=h;function y(a,u,f,d){return(0,i.getEndpoint)(r,"/v1/chains/{chainId}/safes/{address}/module-transactions/",{path:{chainId:a,address:u},query:f},d)}e.getModuleTransactions=y;function M(a,u,f,d){return(0,i.getEndpoint)(r,"/v1/chains/{chainId}/safes/{address}/multisig-transactions/",{path:{chainId:a,address:u},query:f},d)}e.getMultisigTransactions=M;function I(a,u,f="usd",d={}){return(0,i.getEndpoint)(r,"/v1/chains/{chainId}/safes/{address}/balances/{currency}",{path:{chainId:a,address:u,currency:f},query:d})}e.getBalances=I;function z(){return(0,i.getEndpoint)(r,"/v1/balances/supported-fiat-codes")}e.getFiatCurrencies=z;function K(a,u){return(0,i.getEndpoint)(r,"/v1/chains/{chainId}/owners/{address}/safes",{path:{chainId:a,address:u}})}e.getOwnedSafes=K;function D(a){return(0,i.getEndpoint)(r,"/v1/owners/{address}/safes",{path:{address:a}})}e.getAllOwnedSafes=D;function X(a,u,f={}){return(0,i.getEndpoint)(r,"/v1/chains/{chainId}/safes/{address}/collectibles",{path:{chainId:a,address:u},query:f})}e.getCollectibles=X;function ft(a,u,f={},d){return(0,i.getEndpoint)(r,"/v2/chains/{chainId}/safes/{address}/collectibles",{path:{chainId:a,address:u},query:f},d)}e.getCollectiblesPage=ft;function dt(a,u,f={},d){return(0,i.getEndpoint)(r,"/v1/chains/{chainId}/safes/{safe_address}/transactions/history",{path:{chainId:a,safe_address:u},query:f},d)}e.getTransactionHistory=dt;function lt(a,u,f={},d){return(0,i.getEndpoint)(r,"/v1/chains/{chainId}/safes/{safe_address}/transactions/queued",{path:{chainId:a,safe_address:u},query:f},d)}e.getTransactionQueue=lt;function ht(a,u){return(0,i.getEndpoint)(r,"/v1/chains/{chainId}/transactions/{transactionId}",{path:{chainId:a,transactionId:u}})}e.getTransactionDetails=ht;function gt(a,u,f){return(0,i.deleteEndpoint)(r,"/v1/chains/{chainId}/transactions/{safeTxHash}",{path:{chainId:a,safeTxHash:u},body:{signature:f}})}e.deleteTransaction=gt;function yt(a,u,f){return(0,i.postEndpoint)(r,"/v2/chains/{chainId}/safes/{safe_address}/multisig-transactions/estimations",{path:{chainId:a,safe_address:u},body:f})}e.postSafeGasEstimation=yt;function pt(a,u){return(0,i.getEndpoint)(r,"/v1/chains/{chainId}/safes/{safe_address}/nonces",{path:{chainId:a,safe_address:u}})}e.getNonces=pt;function mt(a,u,f){return(0,i.postEndpoint)(r,"/v1/chains/{chainId}/transactions/{safe_address}/propose",{path:{chainId:a,safe_address:u},body:f})}e.proposeTransaction=mt;function Et(a,u,f,d){return(0,i.postEndpoint)(r,"/v1/chains/{chainId}/safes/{safe_address}/views/transaction-confirmation",{path:{chainId:a,safe_address:u},body:{data:f,to:d}})}e.getConfirmationView=Et;function At(a){return(0,i.getEndpoint)(r,"/v1/chains",{query:a})}e.getChainsConfig=At;function bt(a){return(0,i.getEndpoint)(r,"/v1/chains/{chainId}",{path:{chainId:a}})}e.getChainConfig=bt;function Tt(a,u={}){return(0,i.getEndpoint)(r,"/v1/chains/{chainId}/safe-apps",{path:{chainId:a},query:u})}e.getSafeApps=Tt;function _t(a){return(0,i.getEndpoint)(r,"/v1/chains/{chainId}/about/master-copies",{path:{chainId:a}})}e.getMasterCopies=_t;function It(a,u,f){return(0,i.postEndpoint)(r,"/v1/chains/{chainId}/data-decoder",{path:{chainId:a},body:{data:u,to:f}})}e.getDecodedData=It;function St(a,u,f){return(0,i.getEndpoint)(r,"/v1/chains/{chainId}/safes/{safe_address}/messages",{path:{chainId:a,safe_address:u},query:{}},f)}e.getSafeMessages=St;function vt(a,u){return(0,i.getEndpoint)(r,"/v1/chains/{chainId}/messages/{message_hash}",{path:{chainId:a,message_hash:u}})}e.getSafeMessage=vt;function wt(a,u,f){return(0,i.postEndpoint)(r,"/v1/chains/{chainId}/safes/{safe_address}/messages",{path:{chainId:a,safe_address:u},body:f})}e.proposeSafeMessage=wt;function Ot(a,u,f){return(0,i.postEndpoint)(r,"/v1/chains/{chainId}/messages/{message_hash}/signatures",{path:{chainId:a,message_hash:u},body:f})}e.confirmSafeMessage=Ot;function Nt(a,u={}){return(0,i.getEndpoint)(r,"/v2/chains/{chainId}/delegates",{path:{chainId:a},query:u})}e.getDelegates=Nt;function Ct(a){return(0,i.postEndpoint)(r,"/v1/register/notifications",{body:a})}e.registerDevice=Ct;function Dt(a,u,f){return(0,i.deleteEndpoint)(r,"/v1/chains/{chainId}/notifications/devices/{uuid}/safes/{safe_address}",{path:{chainId:a,safe_address:u,uuid:f}})}e.unregisterSafe=Dt;function Pt(a,u){return(0,i.deleteEndpoint)(r,"/v1/chains/{chainId}/notifications/devices/{uuid}",{path:{chainId:a,uuid:u}})}e.unregisterDevice=Pt;function Mt(a,u,f,d){return(0,i.postEndpoint)(r,"/v1/chains/{chainId}/safes/{safe_address}/emails",{path:{chainId:a,safe_address:u},body:f,headers:d})}e.registerEmail=Mt;function Rt(a,u,f,d,w){return(0,i.putEndpoint)(r,"/v1/chains/{chainId}/safes/{safe_address}/emails/{signer}",{path:{chainId:a,safe_address:u,signer:f},body:d,headers:w})}e.changeEmail=Rt;function $t(a,u,f){return(0,i.postEndpoint)(r,"/v1/chains/{chainId}/safes/{safe_address}/emails/{signer}/verify-resend",{path:{chainId:a,safe_address:u,signer:f},body:""})}e.resendEmailVerificationCode=$t;function Lt(a,u,f,d){return(0,i.putEndpoint)(r,"/v1/chains/{chainId}/safes/{safe_address}/emails/{signer}/verify",{path:{chainId:a,safe_address:u,signer:f},body:d})}e.verifyEmail=Lt;function Bt(a,u,f,d){return(0,i.getEndpoint)(r,"/v1/chains/{chainId}/safes/{safe_address}/emails/{signer}",{path:{chainId:a,safe_address:u,signer:f},headers:d})}e.getRegisteredEmail=Bt;function Ht(a,u,f,d){return(0,i.deleteEndpoint)(r,"/v1/chains/{chainId}/safes/{safe_address}/emails/{signer}",{path:{chainId:a,safe_address:u,signer:f},headers:d})}e.deleteRegisteredEmail=Ht;function Ut(a,u,f){return(0,i.postEndpoint)(r,"/v1/chains/{chainId}/safes/{safe_address}/recovery",{path:{chainId:a,safe_address:u},body:f})}e.registerRecoveryModule=Ut;function jt(a){return(0,i.deleteEndpoint)(r,"/v1/subscriptions",{query:a})}e.unsubscribeSingle=jt;function kt(a){return(0,i.deleteEndpoint)(r,"/v1/subscriptions/all",{query:a})}e.unsubscribeAll=kt;function zt(a,u){return(0,i.getEndpoint)(r,"/v1/safes",{query:Object.assign(Object.assign({},u),{safes:a.join(",")})})}e.getSafeOverviews=zt;function Ft(a,u){return(0,i.getEndpoint)(r,"/v1/chains/{chainId}/contracts/{contractAddress}",{path:{chainId:a,contractAddress:u}})}e.getContract=Ft;function Gt(){return(0,i.getEndpoint)(r,"/v1/auth/nonce",{credentials:"include"})}e.getAuthNonce=Gt;function Wt(a){return(0,i.postEndpoint)(r,"/v1/auth/verify",{body:a,credentials:"include"})}e.verifyAuth=Wt;function Vt(a){return(0,i.postEndpoint)(r,"/v1/accounts",{body:a,credentials:"include"})}e.createAccount=Vt;function qt(a){return(0,i.getEndpoint)(r,"/v1/accounts/{address}",{path:{address:a},credentials:"include"})}e.getAccount=qt;function Kt(a){return(0,i.deleteEndpoint)(r,"/v1/accounts/{address}",{path:{address:a},credentials:"include"})}e.deleteAccount=Kt;function Xt(){return(0,i.getEndpoint)(r,"/v1/accounts/data-types")}e.getAccountDataTypes=Xt;function Qt(a){return(0,i.getEndpoint)(r,"/v1/accounts/{address}/data-settings",{path:{address:a},credentials:"include"})}e.getAccountDataSettings=Qt;function Yt(a,u){return(0,i.putEndpoint)(r,"/v1/accounts/{address}/data-settings",{path:{address:a},body:u,credentials:"include"})}e.putAccountDataSettings=Yt})(nn);class gn{constructor(t){this.communicator=t}async getBySafeTxHash(t){if(!t)throw new Error("Invalid safeTxHash");return(await this.communicator.send(m.getTxBySafeTxHash,{safeTxHash:t})).data}async signMessage(t){const n={message:t};return(await this.communicator.send(m.signMessage,n)).data}async signTypedMessage(t){if(!Se(t))throw new Error("Invalid typed data");return(await this.communicator.send(m.signTypedMessage,{typedData:t})).data}async send({txs:t,params:n}){if(!t||!t.length)throw new Error("No transactions were passed");const i={txs:t,params:n};return(await this.communicator.send(m.sendTransactions,i)).data}}const E={eth_call:"eth_call",eth_gasPrice:"eth_gasPrice",eth_getLogs:"eth_getLogs",eth_getBalance:"eth_getBalance",eth_getCode:"eth_getCode",eth_getBlockByHash:"eth_getBlockByHash",eth_getBlockByNumber:"eth_getBlockByNumber",eth_getStorageAt:"eth_getStorageAt",eth_getTransactionByHash:"eth_getTransactionByHash",eth_getTransactionReceipt:"eth_getTransactionReceipt",eth_getTransactionCount:"eth_getTransactionCount",eth_estimateGas:"eth_estimateGas",safe_setSettings:"safe_setSettings"},S={defaultBlockParam:(e="latest")=>e,returnFullTxObjectParam:(e=!1)=>e,blockNumberToHex:e=>Number.isInteger(e)?`0x${e.toString(16)}`:e};class yn{constructor(t){this.communicator=t,this.call=this.buildRequest({call:E.eth_call,formatters:[null,S.defaultBlockParam]}),this.getBalance=this.buildRequest({call:E.eth_getBalance,formatters:[null,S.defaultBlockParam]}),this.getCode=this.buildRequest({call:E.eth_getCode,formatters:[null,S.defaultBlockParam]}),this.getStorageAt=this.buildRequest({call:E.eth_getStorageAt,formatters:[null,S.blockNumberToHex,S.defaultBlockParam]}),this.getPastLogs=this.buildRequest({call:E.eth_getLogs}),this.getBlockByHash=this.buildRequest({call:E.eth_getBlockByHash,formatters:[null,S.returnFullTxObjectParam]}),this.getBlockByNumber=this.buildRequest({call:E.eth_getBlockByNumber,formatters:[S.blockNumberToHex,S.returnFullTxObjectParam]}),this.getTransactionByHash=this.buildRequest({call:E.eth_getTransactionByHash}),this.getTransactionReceipt=this.buildRequest({call:E.eth_getTransactionReceipt}),this.getTransactionCount=this.buildRequest({call:E.eth_getTransactionCount,formatters:[null,S.defaultBlockParam]}),this.getGasPrice=this.buildRequest({call:E.eth_gasPrice}),this.getEstimateGas=n=>this.buildRequest({call:E.eth_estimateGas})([n]),this.setSafeSettings=this.buildRequest({call:E.safe_setSettings})}buildRequest(t){const{call:n,formatters:i}=t;return async s=>{i&&Array.isArray(s)&&i.forEach((c,l)=>{c&&(s[l]=c(s[l]))});const r={call:n,params:s||[]};return(await this.communicator.send(m.rpcCall,r)).data}}}function pn(e,t){return e.exec(t)?.groups}const fe=/^tuple(?<array>(\[(\d*)\])*)$/;function Z(e){let t=e.type;if(fe.test(e.type)&&"components"in e){t="(";const n=e.components.length;for(let s=0;s<n;s++){const r=e.components[s];t+=Z(r),s<n-1&&(t+=", ")}const i=pn(fe,e.type);return t+=`)${i?.array??""}`,Z({...e,type:t})}return"indexed"in e&&e.indexed&&(t=`${t} indexed`),e.name?`${t} ${e.name}`:t}function L(e){let t="";const n=e.length;for(let i=0;i<n;i++){const s=e[i];t+=Z(s),i!==n-1&&(t+=", ")}return t}function mn(e){return e.type==="function"?`function ${e.name}(${L(e.inputs)})${e.stateMutability&&e.stateMutability!=="nonpayable"?` ${e.stateMutability}`:""}${e.outputs.length?` returns (${L(e.outputs)})`:""}`:e.type==="event"?`event ${e.name}(${L(e.inputs)})`:e.type==="error"?`error ${e.name}(${L(e.inputs)})`:e.type==="constructor"?`constructor(${L(e.inputs)})${e.stateMutability==="payable"?" payable":""}`:e.type==="fallback"?"fallback()":"receive() external payable"}function x(e,{includeName:t=!1}={}){if(e.type!=="function"&&e.type!=="event"&&e.type!=="error")throw new wn(e.type);return`${e.name}(${Be(e.inputs,{includeName:t})})`}function Be(e,{includeName:t=!1}={}){return e?e.map(n=>En(n,{includeName:t})).join(t?", ":","):""}function En(e,{includeName:t}){return e.type.startsWith("tuple")?`(${Be(e.components,{includeName:t})})${e.type.slice(5)}`:e.type+(t&&e.name?` ${e.name}`:"")}function j(e,{strict:t=!0}={}){return!e||typeof e!="string"?!1:t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x")}function A(e){return j(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}const He="2.21.22";let de={getDocsUrl:({docsBaseUrl:e,docsPath:t="",docsSlug:n})=>t?`${e??"https://viem.sh"}${t}${n?`#${n}`:""}`:void 0,version:He};class p extends Error{constructor(t,n={}){const i=n.cause instanceof p?n.cause.details:n.cause?.message?n.cause.message:n.details,s=n.cause instanceof p&&n.cause.docsPath||n.docsPath,r=de.getDocsUrl?.({...n,docsPath:s}),o=[t||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...r?[`Docs: ${r}`]:[],...i?[`Details: ${i}`]:[],`Version: ${de.version}`].join(`
`);super(o,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=i,this.docsPath=s,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=t,this.version=He}walk(t){return Ue(this,t)}}function Ue(e,t){return t?.(e)?e:e&&typeof e=="object"&&"cause"in e?Ue(e.cause,t):t?null:e}class An extends p{constructor({expectedLength:t,givenLength:n,type:i}){super([`ABI encoding array length mismatch for type ${i}.`,`Expected length: ${t}`,`Given length: ${n}`].join(`
`),{name:"AbiEncodingArrayLengthMismatchError"})}}class bn extends p{constructor({expectedSize:t,value:n}){super(`Size of bytes "${n}" (bytes${A(n)}) does not match expected size (bytes${t}).`,{name:"AbiEncodingBytesSizeMismatchError"})}}class Tn extends p{constructor({expectedLength:t,givenLength:n}){super(["ABI encoding params/values length mismatch.",`Expected length (params): ${t}`,`Given length (values): ${n}`].join(`
`),{name:"AbiEncodingLengthMismatchError"})}}class le extends p{constructor(t,{docsPath:n}={}){super([`Function ${t?`"${t}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:n,name:"AbiFunctionNotFoundError"})}}class _n extends p{constructor(t,n){super("Found ambiguous types in overloaded ABI items.",{metaMessages:[`\`${t.type}\` in \`${x(t.abiItem)}\`, and`,`\`${n.type}\` in \`${x(n.abiItem)}\``,"","These types encode differently and cannot be distinguished at runtime.","Remove one of the ambiguous items in the ABI."],name:"AbiItemAmbiguityError"})}}class In extends p{constructor({expectedSize:t,givenSize:n}){super(`Expected bytes${t}, got bytes${n}.`,{name:"BytesSizeMismatchError"})}}class Sn extends p{constructor(t,{docsPath:n}){super([`Type "${t}" is not a valid encoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:n,name:"InvalidAbiEncodingType"})}}class vn extends p{constructor(t){super([`Value "${t}" is not a valid array.`].join(`
`),{name:"InvalidArrayError"})}}class wn extends p{constructor(t){super([`"${t}" is not a valid definition type.`,'Valid types: "function", "event", "error"'].join(`
`),{name:"InvalidDefinitionTypeError"})}}class je extends p{constructor({offset:t,position:n,size:i}){super(`Slice ${n==="start"?"starting":"ending"} at offset "${t}" is out-of-bounds (size: ${i}).`,{name:"SliceOffsetOutOfBoundsError"})}}class ke extends p{constructor({size:t,targetSize:n,type:i}){super(`${i.charAt(0).toUpperCase()}${i.slice(1).toLowerCase()} size (${t}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}}function $(e,{dir:t,size:n=32}={}){return typeof e=="string"?O(e,{dir:t,size:n}):On(e,{dir:t,size:n})}function O(e,{dir:t,size:n=32}={}){if(n===null)return e;const i=e.replace("0x","");if(i.length>n*2)throw new ke({size:Math.ceil(i.length/2),targetSize:n,type:"hex"});return`0x${i[t==="right"?"padEnd":"padStart"](n*2,"0")}`}function On(e,{dir:t,size:n=32}={}){if(n===null)return e;if(e.length>n)throw new ke({size:e.length,targetSize:n,type:"bytes"});const i=new Uint8Array(n);for(let s=0;s<n;s++){const r=t==="right";i[r?s:n-s-1]=e[r?s:e.length-s-1]}return i}class Nn extends p{constructor({max:t,min:n,signed:i,size:s,value:r}){super(`Number "${r}" is not in safe ${s?`${s*8}-bit ${i?"signed":"unsigned"} `:""}integer range ${t?`(${n} to ${t})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}}class Cn extends p{constructor({givenSize:t,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${t} bytes.`,{name:"SizeOverflowError"})}}function k(e,{size:t}){if(A(e)>t)throw new Cn({givenSize:A(e),maxSize:t})}const Dn=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function ie(e,t={}){return typeof e=="number"||typeof e=="bigint"?C(e,t):typeof e=="string"?G(e,t):typeof e=="boolean"?ze(e,t):se(e,t)}function ze(e,t={}){const n=`0x${Number(e)}`;return typeof t.size=="number"?(k(n,{size:t.size}),$(n,{size:t.size})):n}function se(e,t={}){let n="";for(let s=0;s<e.length;s++)n+=Dn[e[s]];const i=`0x${n}`;return typeof t.size=="number"?(k(i,{size:t.size}),$(i,{dir:"right",size:t.size})):i}function C(e,t={}){const{signed:n,size:i}=t,s=BigInt(e);let r;i?n?r=(1n<<BigInt(i)*8n-1n)-1n:r=2n**(BigInt(i)*8n)-1n:typeof e=="number"&&(r=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof r=="bigint"&&n?-r-1n:0;if(r&&s>r||s<o){const l=typeof e=="bigint"?"n":"";throw new Nn({max:r?`${r}${l}`:void 0,min:`${o}${l}`,signed:n,size:i,value:`${e}${l}`})}const c=`0x${(n&&s<0?(1n<<BigInt(i*8))+BigInt(s):s).toString(16)}`;return i?$(c,{size:i}):c}const Pn=new TextEncoder;function G(e,t={}){const n=Pn.encode(e);return se(n,t)}const Mn=new TextEncoder;function Fe(e,t={}){return typeof e=="number"||typeof e=="bigint"?$n(e,t):typeof e=="boolean"?Rn(e,t):j(e)?Ge(e,t):We(e,t)}function Rn(e,t={}){const n=new Uint8Array(1);return n[0]=Number(e),typeof t.size=="number"?(k(n,{size:t.size}),$(n,{size:t.size})):n}const v={zero:48,nine:57,A:65,F:70,a:97,f:102};function he(e){if(e>=v.zero&&e<=v.nine)return e-v.zero;if(e>=v.A&&e<=v.F)return e-(v.A-10);if(e>=v.a&&e<=v.f)return e-(v.a-10)}function Ge(e,t={}){let n=e;t.size&&(k(n,{size:t.size}),n=$(n,{dir:"right",size:t.size}));let i=n.slice(2);i.length%2&&(i=`0${i}`);const s=i.length/2,r=new Uint8Array(s);for(let o=0,c=0;o<s;o++){const l=he(i.charCodeAt(c++)),g=he(i.charCodeAt(c++));if(l===void 0||g===void 0)throw new p(`Invalid byte sequence ("${i[c-2]}${i[c-1]}" in "${i}").`);r[o]=l*16+g}return r}function $n(e,t){const n=C(e,t);return Ge(n)}function We(e,t={}){const n=Mn.encode(e);return typeof t.size=="number"?(k(n,{size:t.size}),$(n,{dir:"right",size:t.size})):n}function ge(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function Ln(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function re(e,...t){if(!Ln(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function ye(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Bn(e,t){re(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const F=BigInt(2**32-1),pe=BigInt(32);function Hn(e,t=!1){return t?{h:Number(e&F),l:Number(e>>pe&F)}:{h:Number(e>>pe&F)|0,l:Number(e&F)|0}}function Un(e,t=!1){let n=new Uint32Array(e.length),i=new Uint32Array(e.length);for(let s=0;s<e.length;s++){const{h:r,l:o}=Hn(e[s],t);[n[s],i[s]]=[r,o]}return[n,i]}const jn=(e,t,n)=>e<<n|t>>>32-n,kn=(e,t,n)=>t<<n|e>>>32-n,zn=(e,t,n)=>t<<n-32|e>>>64-n,Fn=(e,t,n)=>e<<n-32|t>>>64-n;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Gn=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),me=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,Wn=e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;function Ee(e){for(let t=0;t<e.length;t++)e[t]=Wn(e[t])}function Vn(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Ve(e){return typeof e=="string"&&(e=Vn(e)),re(e),e}class qn{clone(){return this._cloneInto()}}function Kn(e){const t=i=>e().update(Ve(i)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}const qe=[],Ke=[],Xe=[],Xn=BigInt(0),B=BigInt(1),Qn=BigInt(2),Yn=BigInt(7),Jn=BigInt(256),Zn=BigInt(113);for(let e=0,t=B,n=1,i=0;e<24;e++){[n,i]=[i,(2*n+3*i)%5],qe.push(2*(5*i+n)),Ke.push((e+1)*(e+2)/2%64);let s=Xn;for(let r=0;r<7;r++)t=(t<<B^(t>>Yn)*Zn)%Jn,t&Qn&&(s^=B<<(B<<BigInt(r))-B);Xe.push(s)}const[xn,ei]=Un(Xe,!0),Ae=(e,t,n)=>n>32?zn(e,t,n):jn(e,t,n),be=(e,t,n)=>n>32?Fn(e,t,n):kn(e,t,n);function ti(e,t=24){const n=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let o=0;o<10;o++)n[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){const c=(o+8)%10,l=(o+2)%10,g=n[l],h=n[l+1],y=Ae(g,h,1)^n[c],M=be(g,h,1)^n[c+1];for(let I=0;I<50;I+=10)e[o+I]^=y,e[o+I+1]^=M}let s=e[2],r=e[3];for(let o=0;o<24;o++){const c=Ke[o],l=Ae(s,r,c),g=be(s,r,c),h=qe[o];s=e[h],r=e[h+1],e[h]=l,e[h+1]=g}for(let o=0;o<50;o+=10){for(let c=0;c<10;c++)n[c]=e[o+c];for(let c=0;c<10;c++)e[o+c]^=~n[(c+2)%10]&n[(c+4)%10]}e[0]^=xn[i],e[1]^=ei[i]}n.fill(0)}class oe extends qn{constructor(t,n,i,s=!1,r=24){if(super(),this.blockLen=t,this.suffix=n,this.outputLen=i,this.enableXOF=s,this.rounds=r,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,ge(i),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Gn(this.state)}keccak(){me||Ee(this.state32),ti(this.state32,this.rounds),me||Ee(this.state32),this.posOut=0,this.pos=0}update(t){ye(this);const{blockLen:n,state:i}=this;t=Ve(t);const s=t.length;for(let r=0;r<s;){const o=Math.min(n-this.pos,s-r);for(let c=0;c<o;c++)i[this.pos++]^=t[r++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:i,blockLen:s}=this;t[i]^=n,n&128&&i===s-1&&this.keccak(),t[s-1]^=128,this.keccak()}writeInto(t){ye(this,!1),re(t),this.finish();const n=this.state,{blockLen:i}=this;for(let s=0,r=t.length;s<r;){this.posOut>=i&&this.keccak();const o=Math.min(i-this.posOut,r-s);t.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return ge(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(Bn(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:n,suffix:i,outputLen:s,rounds:r,enableXOF:o}=this;return t||(t=new oe(n,i,s,o,r)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=r,t.suffix=i,t.outputLen=s,t.enableXOF=o,t.destroyed=this.destroyed,t}}const ni=(e,t,n)=>Kn(()=>new oe(t,e,n)),ii=ni(1,136,256/8);function _(e,t){const n=t||"hex",i=ii(j(e,{strict:!1})?Fe(e):e);return n==="bytes"?i:ie(i)}const si=e=>_(Fe(e));function ri(e){return si(e)}function oi(e){let t=!0,n="",i=0,s="",r=!1;for(let o=0;o<e.length;o++){const c=e[o];if(["(",")",","].includes(c)&&(t=!0),c==="("&&i++,c===")"&&i--,!!t){if(i===0){if(c===" "&&["event","function",""].includes(s))s="";else if(s+=c,c===")"){r=!0;break}continue}if(c===" "){e[o-1]!==","&&n!==","&&n!==",("&&(n="",t=!1);continue}s+=c,n+=c}}if(!r)throw new p("Unable to normalize signature.");return s}const ai=e=>{const t=typeof e=="string"?e:mn(e);return oi(t)};function Qe(e){return ri(ai(e))}const ci=Qe;class Ye extends p{constructor({address:t}){super(`Address "${t}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."],name:"InvalidAddressError"})}}class Je extends Map{constructor(t){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=t}get(t){const n=super.get(t);return super.has(t)&&n!==void 0&&(this.delete(t),super.set(t,n)),n}set(t,n){if(super.set(t,n),this.maxSize&&this.size>this.maxSize){const i=this.keys().next().value;i&&this.delete(i)}return this}}const Q=new Je(8192);function ui(e,t){if(Q.has(`${e}.${t}`))return Q.get(`${e}.${t}`);const n=e.substring(2).toLowerCase(),i=_(We(n),"bytes"),s=n.split("");for(let o=0;o<40;o+=2)i[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(i[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const r=`0x${s.join("")}`;return Q.set(`${e}.${t}`,r),r}const fi=/^0x[a-fA-F0-9]{40}$/,Y=new Je(8192);function H(e,t){const{strict:n=!0}=t??{},i=`${e}.${n}`;if(Y.has(i))return Y.get(i);const s=fi.test(e)?e.toLowerCase()===e?!0:n?ui(e)===e:!0:!1;return Y.set(i,s),s}function N(e){return typeof e[0]=="string"?Ze(e):di(e)}function di(e){let t=0;for(const s of e)t+=s.length;const n=new Uint8Array(t);let i=0;for(const s of e)n.set(s,i),i+=s.length;return n}function Ze(e){return`0x${e.reduce((t,n)=>t+n.replace("0x",""),"")}`}function xe(e,t,n,{strict:i}={}){return j(e,{strict:!1})?hi(e,t,n,{strict:i}):li(e,t,n,{strict:i})}function et(e,t){if(typeof t=="number"&&t>0&&t>A(e)-1)throw new je({offset:t,position:"start",size:A(e)})}function tt(e,t,n){if(typeof t=="number"&&typeof n=="number"&&A(e)!==n-t)throw new je({offset:n,position:"end",size:A(e)})}function li(e,t,n,{strict:i}={}){et(e,t);const s=e.slice(t,n);return i&&tt(s,t,n),s}function hi(e,t,n,{strict:i}={}){et(e,t);const s=`0x${e.replace("0x","").slice((t??0)*2,(n??e.length)*2)}`;return i&&tt(s,t,n),s}function ae(e,t){if(e.length!==t.length)throw new Tn({expectedLength:e.length,givenLength:t.length});const n=gi({params:e,values:t}),i=ue(n);return i.length===0?"0x":i}function gi({params:e,values:t}){const n=[];for(let i=0;i<e.length;i++)n.push(ce({param:e[i],value:t[i]}));return n}function ce({param:e,value:t}){const n=_i(e.type);if(n){const[i,s]=n;return pi(t,{length:i,param:{...e,type:s}})}if(e.type==="tuple")return Ti(t,{param:e});if(e.type==="address")return yi(t);if(e.type==="bool")return Ei(t);if(e.type.startsWith("uint")||e.type.startsWith("int")){const i=e.type.startsWith("int");return Ai(t,{signed:i})}if(e.type.startsWith("bytes"))return mi(t,{param:e});if(e.type==="string")return bi(t);throw new Sn(e.type,{docsPath:"/docs/contract/encodeAbiParameters"})}function ue(e){let t=0;for(let r=0;r<e.length;r++){const{dynamic:o,encoded:c}=e[r];o?t+=32:t+=A(c)}const n=[],i=[];let s=0;for(let r=0;r<e.length;r++){const{dynamic:o,encoded:c}=e[r];o?(n.push(C(t+s,{size:32})),i.push(c),s+=A(c)):n.push(c)}return N([...n,...i])}function yi(e){if(!H(e))throw new Ye({address:e});return{dynamic:!1,encoded:O(e.toLowerCase())}}function pi(e,{length:t,param:n}){const i=t===null;if(!Array.isArray(e))throw new vn(e);if(!i&&e.length!==t)throw new An({expectedLength:t,givenLength:e.length,type:`${n.type}[${t}]`});let s=!1;const r=[];for(let o=0;o<e.length;o++){const c=ce({param:n,value:e[o]});c.dynamic&&(s=!0),r.push(c)}if(i||s){const o=ue(r);if(i){const c=C(r.length,{size:32});return{dynamic:!0,encoded:r.length>0?N([c,o]):c}}if(s)return{dynamic:!0,encoded:o}}return{dynamic:!1,encoded:N(r.map(({encoded:o})=>o))}}function mi(e,{param:t}){const[,n]=t.type.split("bytes"),i=A(e);if(!n){let s=e;return i%32!==0&&(s=O(s,{dir:"right",size:Math.ceil((e.length-2)/2/32)*32})),{dynamic:!0,encoded:N([O(C(i,{size:32})),s])}}if(i!==Number.parseInt(n))throw new bn({expectedSize:Number.parseInt(n),value:e});return{dynamic:!1,encoded:O(e,{dir:"right"})}}function Ei(e){if(typeof e!="boolean")throw new p(`Invalid boolean value: "${e}" (type: ${typeof e}). Expected: \`true\` or \`false\`.`);return{dynamic:!1,encoded:O(ze(e))}}function Ai(e,{signed:t}){return{dynamic:!1,encoded:C(e,{size:32,signed:t})}}function bi(e){const t=G(e),n=Math.ceil(A(t)/32),i=[];for(let s=0;s<n;s++)i.push(O(xe(t,s*32,(s+1)*32),{dir:"right"}));return{dynamic:!0,encoded:N([O(C(A(t),{size:32})),...i])}}function Ti(e,{param:t}){let n=!1;const i=[];for(let s=0;s<t.components.length;s++){const r=t.components[s],o=Array.isArray(e)?s:r.name,c=ce({param:r,value:e[o]});i.push(c),c.dynamic&&(n=!0)}return{dynamic:n,encoded:n?ue(i):N(i.map(({encoded:s})=>s))}}function _i(e){const t=e.match(/^(.*)\[(\d+)?\]$/);return t?[t[2]?Number(t[2]):null,t[1]]:void 0}const nt=e=>xe(Qe(e),0,4);function Ii(e){const{abi:t,args:n=[],name:i}=e,s=j(i,{strict:!1}),r=t.filter(c=>s?c.type==="function"?nt(c)===i:c.type==="event"?ci(c)===i:!1:"name"in c&&c.name===i);if(r.length===0)return;if(r.length===1)return r[0];let o;for(const c of r){if(!("inputs"in c))continue;if(!n||n.length===0){if(!c.inputs||c.inputs.length===0)return c;continue}if(!c.inputs||c.inputs.length===0||c.inputs.length!==n.length)continue;if(n.every((g,h)=>{const y="inputs"in c&&c.inputs[h];return y?ee(g,y):!1})){if(o&&"inputs"in o&&o.inputs){const g=it(c.inputs,o.inputs,n);if(g)throw new _n({abiItem:c,type:g[0]},{abiItem:o,type:g[1]})}o=c}}return o||r[0]}function ee(e,t){const n=typeof e,i=t.type;switch(i){case"address":return H(e,{strict:!1});case"bool":return n==="boolean";case"function":return n==="string";case"string":return n==="string";default:return i==="tuple"&&"components"in t?Object.values(t.components).every((s,r)=>ee(Object.values(e)[r],s)):/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(i)?n==="number"||n==="bigint":/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(i)?n==="string"||e instanceof Uint8Array:/[a-z]+[1-9]{0,3}(\[[0-9]{0,}\])+$/.test(i)?Array.isArray(e)&&e.every(s=>ee(s,{...t,type:i.replace(/(\[[0-9]{0,}\])$/,"")})):!1}}function it(e,t,n){for(const i in e){const s=e[i],r=t[i];if(s.type==="tuple"&&r.type==="tuple"&&"components"in s&&"components"in r)return it(s.components,r.components,n[i]);const o=[s.type,r.type];if(o.includes("address")&&o.includes("bytes20")?!0:o.includes("address")&&o.includes("string")?H(n[i],{strict:!1}):o.includes("address")&&o.includes("bytes")?H(n[i],{strict:!1}):!1)return o}}const Te="/docs/contract/encodeFunctionData";function Si(e){const{abi:t,args:n,functionName:i}=e;let s=t[0];if(i){const r=Ii({abi:t,args:n,name:i});if(!r)throw new le(i,{docsPath:Te});s=r}if(s.type!=="function")throw new le(void 0,{docsPath:Te});return{abi:[s],functionName:nt(x(s))}}function _e(e){const{args:t}=e,{abi:n,functionName:i}=e.abi.length===1&&e.functionName?.startsWith("0x")?e:Si(e),s=n[0],r=i,o="inputs"in s&&s.inputs?ae(s.inputs,t??[]):void 0;return Ze([r,o??"0x"])}const vi=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,wi=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function Oi(e){const{domain:t={},message:n,primaryType:i}=e,s={EIP712Domain:Mi({domain:t}),...e.types};Pi({domain:t,message:n,primaryType:i,types:s});const r=["0x1901"];return t&&r.push(Ni({domain:t,types:s})),i!=="EIP712Domain"&&r.push(st({data:n,primaryType:i,types:s})),_(N(r))}function Ni({domain:e,types:t}){return st({data:e,primaryType:"EIP712Domain",types:t})}function st({data:e,primaryType:t,types:n}){const i=rt({data:e,primaryType:t,types:n});return _(i)}function rt({data:e,primaryType:t,types:n}){const i=[{type:"bytes32"}],s=[Ci({primaryType:t,types:n})];for(const r of n[t]){const[o,c]=at({types:n,name:r.name,type:r.type,value:e[r.name]});i.push(o),s.push(c)}return ae(i,s)}function Ci({primaryType:e,types:t}){const n=ie(Di({primaryType:e,types:t}));return _(n)}function Di({primaryType:e,types:t}){let n="";const i=ot({primaryType:e,types:t});i.delete(e);const s=[e,...Array.from(i).sort()];for(const r of s)n+=`${r}(${t[r].map(({name:o,type:c})=>`${c} ${o}`).join(",")})`;return n}function ot({primaryType:e,types:t},n=new Set){const s=e.match(/^\w*/u)?.[0];if(n.has(s)||t[s]===void 0)return n;n.add(s);for(const r of t[s])ot({primaryType:r.type,types:t},n);return n}function at({types:e,name:t,type:n,value:i}){if(e[n]!==void 0)return[{type:"bytes32"},_(rt({data:i,primaryType:n,types:e}))];if(n==="bytes")return i=`0x${(i.length%2?"0":"")+i.slice(2)}`,[{type:"bytes32"},_(i)];if(n==="string")return[{type:"bytes32"},_(ie(i))];if(n.lastIndexOf("]")===n.length-1){const s=n.slice(0,n.lastIndexOf("[")),r=i.map(o=>at({name:t,type:s,types:e,value:o}));return[{type:"bytes32"},_(ae(r.map(([o])=>o),r.map(([,o])=>o)))]}return[{type:n},i]}function Pi(e){const{domain:t,message:n,primaryType:i,types:s}=e,r=(o,c)=>{for(const l of o){const{name:g,type:h}=l,y=c[g],M=h.match(wi);if(M&&(typeof y=="number"||typeof y=="bigint")){const[K,D,X]=M;C(y,{signed:D==="int",size:Number.parseInt(X)/8})}if(h==="address"&&typeof y=="string"&&!H(y))throw new Ye({address:y});const I=h.match(vi);if(I){const[K,D]=I;if(D&&A(y)!==Number.parseInt(D))throw new In({expectedSize:Number.parseInt(D),givenSize:A(y)})}const z=s[h];z&&r(z,y)}};s.EIP712Domain&&t&&r(s.EIP712Domain,t),i!=="EIP712Domain"&&r(s[i],n)}function Mi({domain:e}){return[typeof e?.name=="string"&&{name:"name",type:"string"},e?.version&&{name:"version",type:"string"},typeof e?.chainId=="number"&&{name:"chainId",type:"uint256"},e?.verifyingContract&&{name:"verifyingContract",type:"address"},e?.salt&&{name:"salt",type:"bytes32"}].filter(Boolean)}const Ri=`Ethereum Signed Message:
`;function $i(e){const t=typeof e=="string"?G(e):typeof e.raw=="string"?e.raw:se(e.raw),n=G(`${Ri}${A(t)}`);return N([n,t])}function Li(e,t){return _($i(e),t)}const Bi="0x1626ba7e",Hi="0x20c13b0b",te=4001;class U extends Error{constructor(t,n,i){super(t),this.code=n,this.data=i,Object.setPrototypeOf(this,U.prototype)}}class ct{constructor(t){this.communicator=t}async getPermissions(){return(await this.communicator.send(m.wallet_getPermissions,void 0)).data}async requestPermissions(t){if(!this.isPermissionRequestValid(t))throw new U("Permissions request is invalid",te);try{return(await this.communicator.send(m.wallet_requestPermissions,t)).data}catch{throw new U("Permissions rejected",te)}}isPermissionRequestValid(t){return t.every(n=>typeof n=="object"?Object.keys(n).every(i=>!!Object.values(J).includes(i)):!1)}}const Ie=(e,t)=>t.some(n=>n.parentCapability===e),Ui=()=>(e,t,n)=>{const i=n.value;return n.value=async function(){const s=new ct(this.communicator);let r=await s.getPermissions();if(Ie(t,r)||(r=await s.requestPermissions([{[t]:{}}])),!Ie(t,r))throw new U("Permissions rejected",te);return i.apply(this)},n};var ji=function(e,t,n,i){var s=arguments.length,r=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};class ut{constructor(t){this.communicator=t}async getChainInfo(){return(await this.communicator.send(m.getChainInfo,void 0)).data}async getInfo(){return(await this.communicator.send(m.getSafeInfo,void 0)).data}async experimental_getBalances({currency:t="usd"}={}){return(await this.communicator.send(m.getSafeBalances,{currency:t})).data}async check1271Signature(t,n="0x"){const i=await this.getInfo(),s=_e({abi:[{constant:!1,inputs:[{name:"_dataHash",type:"bytes32"},{name:"_signature",type:"bytes"}],name:"isValidSignature",outputs:[{name:"",type:"bytes4"}],payable:!1,stateMutability:"nonpayable",type:"function"}],functionName:"isValidSignature",args:[t,n]}),r={call:E.eth_call,params:[{to:i.safeAddress,data:s},"latest"]};try{return(await this.communicator.send(m.rpcCall,r)).data.slice(0,10).toLowerCase()===Bi}catch{return!1}}async check1271SignatureBytes(t,n="0x"){const i=await this.getInfo(),s=_e({abi:[{constant:!1,inputs:[{name:"_data",type:"bytes"},{name:"_signature",type:"bytes"}],name:"isValidSignature",outputs:[{name:"",type:"bytes4"}],payable:!1,stateMutability:"nonpayable",type:"function"}],functionName:"isValidSignature",args:[t,n]}),r={call:E.eth_call,params:[{to:i.safeAddress,data:s},"latest"]};try{return(await this.communicator.send(m.rpcCall,r)).data.slice(0,10).toLowerCase()===Hi}catch{return!1}}calculateMessageHash(t){return Li(t)}calculateTypedMessageHash(t){const n=typeof t.domain.chainId=="object"?t.domain.chainId.toNumber():Number(t.domain.chainId);let i=t.primaryType;if(!i){const s=Object.values(t.types),r=Object.keys(t.types).filter(o=>s.every(c=>c.every(({type:l})=>l.replace("[","").replace("]","")!==o)));if(r.length===0||r.length>1)throw new Error("Please specify primaryType");i=r[0]}return Oi({message:t.message,domain:{...t.domain,chainId:n,verifyingContract:t.domain.verifyingContract,salt:t.domain.salt},types:t.types,primaryType:i})}async getOffChainSignature(t){return(await this.communicator.send(m.getOffChainSignature,t)).data}async isMessageSigned(t,n="0x"){let i;if(typeof t=="string"&&(i=async()=>{const s=this.calculateMessageHash(t);return await this.isMessageHashSigned(s,n)}),Se(t)&&(i=async()=>{const s=this.calculateTypedMessageHash(t);return await this.isMessageHashSigned(s,n)}),i)return await i();throw new Error("Invalid message type")}async isMessageHashSigned(t,n="0x"){const i=[this.check1271Signature.bind(this),this.check1271SignatureBytes.bind(this)];for(const s of i)if(await s(t,n))return!0;return!1}async getEnvironmentInfo(){return(await this.communicator.send(m.getEnvironmentInfo,void 0)).data}async requestAddressBook(){return(await this.communicator.send(m.requestAddressBook,void 0)).data}}ji([Ui()],ut.prototype,"requestAddressBook",null);class ki{constructor(t={}){const{allowedDomains:n=null,debug:i=!1}=t;this.communicator=new tn(n,i),this.eth=new yn(this.communicator),this.txs=new gn(this.communicator),this.safe=new ut(this.communicator),this.wallet=new ct(this.communicator)}}const Fi=ki;export{W as MessageFormatter,m as Methods,E as RPC_CALLS,J as RestrictedMethods,Fi as default,Jt as getSDKVersion,Se as isObjectEIP712TypedData};
